<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Services</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
    


</head>

<body>
    <!-- --------------------------nav bar---------------------------- -->
<nav class="navbar navbar-expand-lg" style="background-color: rgb(114,47,250); color:white;">
        <div class="container-fluid">
            <a class="navbar-brand active" href="#">Budgect Calculator</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div    div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">

                </ul>
                <form class="d-flex" role="search">
                    
                    <a class="btn btn-outline-light me-4" onclick="logout()">Logout</a>
                </form>
            </div>
        </div>
    </nav>
    <!-- ------------------------------------------------------------- -->
    <div class="text-center mt-4">
        <h2 id="head1">Welcome </h2>
    </div>
    <!--  -->
    <div class="container w-75 mt-5" style="display: flex;flex-wrap: wrap;">
        <div class="card w-50">
            <h5 class="card-header">Featured</h5>
            <div class="card-body ">
               <div class="mb-4"> <input type="text" class="form-control" id="incometype"  placeholder="Enter Income Type "></div>
                <div class="mb-4"><input type="text" class="form-control" id="income" class="w-100 mt-4" placeholder="Enter Amount"></div>
               <div class="mb-4 text-center"> <button type="button" class="btn btn-outline-dark" onclick="submitincome()">Info</button></div>
            </div>
          </div>
          <div class="card w-50">
            <h5 class="card-header">Featured</h5>
            <div class="card-body">
                <div class="mb-4"><input type="text" class="form-control" id="expntype" class="w-100"  placeholder="Enter Expense Type"></div>
               <div class="mb-4"> <input type="text" class="form-control" id="expn" class="w-100" placeholder="Enter Amount "></div>
               <div class="mb-4 text-center"> <button type="button" onclick="submitexpn()" class="btn btn-outline-dark">Info</button></div>
            </div>
        </div>
        
        <div class="card w-50 my-3" style="background-color:rgb(140, 228, 140) ;">
            <div class="card-body" >
                <h1 id="bal1"></h1>
              This is some text within a card body.
            </div>
          </div>
          <div class="card w-50 my-3" style="background-color:pink;">
            <div class="card-body">
                <h1 id="s1"></h1>
              This is some text within a card body.
            </div>
        </div>
    </div>
    <!-- -------------------- -->
   
    <script>
        uname = localStorage.getItem('loguname')
        head1.innerHTML += uname
        bal = localStorage.getItem(uname)
        b = JSON.parse(bal)
        console.log(b.uname);
        console.log(b.balance);
        bal1.innerHTML += `<div class="text-center mt-3 fs-2 fw-bold">${b.balance}</div>`
        s1.innerHTML += `<div class="text-center mt-3 fs-2 fw-bold">${b.spend}</div>`
        ilist = []
         elist = []
    
        function submitincome() {
            if (income.value === '' || incometype.value === '') {
        alert('Enter valid Details');
    } else {
        var amount = parseFloat(income.value); // Parse the value to float
        b.balance += amount;
        bal1.innerHTML = `<div class="text-center mt-3 fs-2 fw-bold">${b.balance}</div>`;
        localStorage.setItem(uname, JSON.stringify(b));

        var newIncome = { // Create a new object for income
            type: incometype.value,
            amt: amount, // Assign parsed amount
            date: new Date().toLocaleString()
        };

        ilist.push(newIncome);
        localStorage.setItem('income', JSON.stringify(ilist));
        b.income = ilist;
        localStorage.setItem(uname, JSON.stringify(b));

        income.value = '';
        incometype.value = '';
    }
}
        function submitexpn() {
            if (expntype.value == '' || expn.value == '') {
                alert('Enter valid Details')
            }
            else {
                typ = expntype.value
                spen = parseFloat(expn.value)
                if (spen > b.balance) {
                    alert(`Insufficient Balance....!`)
                }
                else {
                    b.spend += spen
                    s1.innerHTML = `<div class="text-center mt-3 fs-2 fw-bold">${b.spend}</div>`
                    b.balance -= spen
                    bal1.innerHTML = `<div class="text-center mt-3 fs-2 fw-bold">${b.balance}</div>`
                    localStorage.setItem(uname, JSON.stringify(b));
                    expense = {
                        type: expntype.value,
                        amt: expn.value,
                        date: new Date().toLocaleString()
                    }
                    elist.push(expense)
                    localStorage.setItem('expense', JSON.stringify(elist))
                    b.expense = elist;
                    localStorage.setItem(uname, JSON.stringify(b));
                    expntype.value = '';
                    expn.value = '';
                }
            }
        }
        // b.expense = elist;
        // localStorage.setItem(uname, JSON.stringify(b));
        // localStorage.setItem('expense', JSON.stringify(elist))
    
    
        function logout(){
            ilist1 = localStorage.getItem('income')
            window.location = 'index.html'
        }
    
        // function genT() {
        //     console.log(b.income);
        //     console.log(b.expense.length);
        //     htmlData = ''
        //     b.expense.forEach(n => {
        //         htmlData = `
        //         <tr>
        //             <td class="">${n.type}</td>
        //             <td class="">${n.amt}</td>
        //             <td class="">${n.date}</td>
        //         </tr>
        //         `
        //         result.innerHTML += htmlData
        //     }
        //     );
    
        //     htmlData = ''
        //     b.income.forEach(n => {
        //         htmlData = `
        //         <tr>
        //             <td class="">${n.type}</td>
        //             <td class="">${n.amt}</td>
        //             <td class="">${n.date}</td>
        //         </tr>
        //         `
        //         result1.innerHTML += htmlData
        //     }
        //     );
        //     var xValues = b.expense.map(n => n.type);
        //     var yValues = b.expense.map(n => parseFloat(n.amt));
        //     var barColors = [
        //         "#b91d47",
        //         "#00aba9",
        //         "#2b5797",
        //         "#e8c3b9",
        //         "#1e7145"
        //     ];
    
        //     new Chart("myChart", {
        //         type: "pie",
        //         data: {
        //             labels: xValues,
        //             datasets: [{
        //                 backgroundColor: barColors,
        //                 data: yValues
        //             }]
        //         },
        //         options: {
        //             title: {
        //                 display: true,
        //                 text: "Expense Chart"
        //             }
        //         }
        //     });
        // }
    
        // function closeT() {
        //     result1.innerHTML = ` `
        //     result.innerHTML = ` `
        // }
    
    
    
    
    
    </script>

</body>

</html>